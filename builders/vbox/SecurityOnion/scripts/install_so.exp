#!/usr/bin/expect -f
#
# This Expect script was generated by autoexpect on Mon Feb  7 21:30:38 2022
# Expect and autoexpect were both written by Don Libes, NIST.
#
# Note that autoexpect does not guarantee a working script.  It
# necessarily has to guess about certain things.  Two reasons a script
# might fail are:
#
# 1) timing - A surprising number of programs (rn, ksh, zsh, telnet,
# etc.) and devices discard or ignore keystrokes that arrive "too
# quickly" after prompts.  If you find your new script hanging up at
# one spot, try adding a short sleep just before the previous send.
# Setting "force_conservative" to 1 (see below) makes Expect do this
# automatically - pausing briefly before sending each character.  This
# pacifies every program I know of.  The -c flag makes the script do
# this in the first place.  The -C flag allows you to define a
# character to toggle this mode off and on.

set force_conservative 0  ;# set to 1 to force conservative mode even if
			  ;# script wasn't run conservatively originally
if {$force_conservative} {
	set send_slow {1 .1}
	proc send {ignore arg} {
		sleep .1
		exp_send -s -- $arg
	}
}

#
# 2) differing output - Some programs produce different output each time
# they run.  The "date" command is an obvious example.  Another is
# ftp, if it produces throughput statistics at the end of a file
# transfer.  If this causes a problem, delete these patterns or replace
# them with wildcards.  An alternative is to use the -p flag (for
# "prompt") which makes Expect only look for the last line of output
# (i.e., the prompt).  The -P flag allows you to define a character to
# toggle this mode off and on.
#
# Read the man page for more info.
#
# -Don


set timeout -1
spawn sudo SecurityOnion/setup/so-setup iso
match_max 100000
expect -exact "Getting started...\r
\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[13;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[14;69H│                                                                         │\[97m\[40m \[15;69H\[30m\[47m│ Welcome to Security Onion Setup!                                        │\[97m\[40m \[16;69H\[30m\[47m│                                                                         │\[97m\[40m \[17;69H\[30m\[47m│ You can use Setup for lots of different use cases from a small          │\[97m\[40m \[18;69H\[30m\[47m│ standalone installation to a large distributed deployment for your      │\[97m\[40m \[19;69H\[30m\[47m│ enterprise. Don't forget to review the documentation at:                │\[97m\[40m \[20;69H\[30m\[47m│ https://docs.securityonion.net                                          │\[97m\[40m \[21;69H\[30m\[47m│                                                                         │\[97m\[40m \[22;69H\[30m\[47m│ Setup uses keyboard navigation and you can use arrow keys to move       │\[97m\[40m \[23;69H\[30m\[47m│ around.  Certain screens may provide a list and ask you to select one   │\[97m\[40m \[24;69H\[30m\[47m│ or more items from that list.  You can use \[SPACE\] to select items and  │\[97m\[40m \[25;69H\[30m\[47m│ \[ENTER\] to proceed to the next screen.                                  │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m│ Would you like to continue?                                             │\[97m\[40m \[28;69H\[30m\[47m│                                                                         │\[97m\[40m \[29;69H\[30m\[47m│                                                                         │\[97m\[40m \[30;69H\[30m\[47m│                    \[37m\[41m<Yes>\[30m\[47m                       <No>                     │\[97m\[40m \[31;69H\[30m\[47m│                                                                         │\[97m\[40m \[32;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[33;70H                                                                           \[30;91H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[18;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[19;69H│ Select an option                                                        │\[97m\[40m \[20;69H\[30m\[47m│                                                                         │\[97m\[40m \[21;69H\[30m\[47m│   \[37m\[41mInstall               Run the standard Security Onion installation \[30m\[47m   │\[97m\[40m \[22;69H\[30m\[47m│   Configure Network     Configure networking only                       │\[97m\[40m \[23;69H\[30m\[47m│                                                                         │\[97m\[40m \[24;69H\[30m\[47m│                                                                         │\[97m\[40m \[25;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[28;70H                                                                           \[21;73H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[17;74H\[30m\[47m┌──────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├───────────────┐\[18;74H│ Choose install type.                                          │\[97m\[40m \[19;74H\[30m\[47m│ See https://docs.securityonion.net/architecture for details.  │\[97m\[40m \[20;74H\[30m\[47m│                                                               │\[97m\[40m \[21;74H\[30m\[47m│    \[37m\[44m(\[41m*\[44m) EVAL         Evaluation mode (not for production)   \[30m\[47m   │\[97m\[40m \[22;74H\[30m\[47m│    \[37m\[44m( ) STANDALONE   Standalone production install          \[30m\[47m   │\[97m\[40m \[23;74H\[30m\[47m│    \[37m\[44m( ) DISTRIBUTED  Distributed install submenu            \[30m\[47m   │\[97m\[40m \[24;74H\[30m\[47m│    \[37m\[44m( ) IMPORT       Standalone to import PCAP or log files \[30m\[47m   │\[97m\[40m \[25;74H\[30m\[47m│    \[37m\[44m( ) OTHER        Other install types                    \[30m\[47m   │\[97m\[40m \[26;74H\[30m\[47m│                                                               │\[97m\[40m \[27;74H\[30m\[47m│                <Ok>                    <Cancel>               │\[97m\[40m \[28;74H\[30m\[47m│                                                               │\[97m\[40m \[29;74H\[30m\[47m└───────────────────────────────────────────────────────────────┘\[97m\[40m \[30;75H                                                                 \[21;83H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[?25l\[?12l\[?25h\[13;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[14;69H│                                                                         │\[97m\[40m \[15;69H\[30m\[47m│                                                                         │\[97m\[40m \[16;69H\[30m\[47m│ Starting in Elastic Stack version 7.11, the Elastic Stack binaries are  │\[97m\[40m \[17;69H\[30m\[47m│ only available under the Elastic License:                               │\[97m\[40m \[18;69H\[30m\[47m│ https://securityonion.net/elastic-license                               │\[97m\[40m \[19;69H\[30m\[47m│                                                                         │\[97m\[40m \[20;69H\[30m\[47m│ Please review the Elastic License:                                      │\[97m\[40m \[21;69H\[30m\[47m│ https://www.elastic.co/licensing/elastic-license                        │\[97m\[40m \[22;69H\[30m\[47m│                                                                         │\[97m\[40m \[23;69H\[30m\[47m│ Do you agree to the terms of the Elastic License?                       │\[97m\[40m \[24;69H\[30m\[47m│                                                                         │\[97m\[40m \[25;69H\[30m\[47m│ If so, type AGREE to accept the Elastic License and continue.           │\[97m\[40m \[26;69H\[30m\[47m│ Otherwise, press Enter to exit this program without making any changes. │\[97m\[40m \[27;69H\[30m\[47m│                                                                         │\[97m\[40m \[28;69H\[30m\[47m│ \[37m\[44m_______________________________________________________________________\[30m\[47m │\[97m\[40m \[29;69H\[30m\[47m│                                                                         │\[97m\[40m \[30;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[31;69H\[30m\[47m│                                                                         │\[97m\[40m \[32;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[33;70H                                                                           \[28;71H"
send -- "a"
expect -exact "\[37m\[44ma"
send -- "gree\r"
expect -exact "\[?25l\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[18;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[19;69H│                                                                         │\[97m\[40m \[20;69H\[30m\[47m│ This machine currently has 1 NIC, but needs 2 to meet minimum           │\[97m\[40m \[21;69H\[30m\[47m│ requirements. Press YES to continue anyway, or press NO to cancel.      │\[97m\[40m \[22;69H\[30m\[47m│                                                                         │\[97m\[40m \[23;69H\[30m\[47m│                                                                         │\[97m\[40m \[24;69H\[30m\[47m│                                                                         │\[97m\[40m \[25;69H\[30m\[47m│                    \[37m\[41m<Yes>\[30m\[47m                       <No>                     │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[28;70H                                                                           \[25;91H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[?25l\[?12l\[?25h\[18;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[19;69H│ Enter the hostname (not FQDN) you would like to set:                    │\[97m\[40m \[20;69H\[30m\[47m│                                                                         │\[97m\[40m \[21;69H\[30m\[47m│ \[37m\[44msecurityonion__________________________________________________________\[30m\[47m │\[97m\[40m \[22;69H\[30m\[47m│                                                                         │\[97m\[40m \[23;69H\[30m\[47m│                                                                         │\[97m\[40m \[24;69H\[30m\[47m│                                                                         │\[97m\[40m \[25;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[28;70H                                                                           \[21;84H"
send -- "2"
expect -exact "\[37m\[44m2"
send -- "\r"
expect -exact "\[?25l\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[13;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[14;69H│ Please select your management NIC:                                      │\[97m\[40m \[15;69H\[30m\[47m│                                                                         │\[97m\[40m \[16;69H\[30m\[47m│    \[37m\[44m(\[41m \[44m) enp0s3  08:00:27:ed:b3:43  Link UP \[30m\[47m                              │\[97m\[40m \[17;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[18;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[19;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[20;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[21;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[22;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[23;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[24;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[25;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[26;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[27;69H\[30m\[47m│    \[37m\[44m                                       \[30m\[47m                              │\[97m\[40m \[28;69H\[30m\[47m│                                                                         │\[97m\[40m \[29;69H\[30m\[47m│                                                                         │\[97m\[40m \[30;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[31;69H\[30m\[47m│                                                                         │\[97m\[40m \[32;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[33;70H                                                                           \[16;78H"
send -- " "
expect -exact "\[16;75H\[37m\[41m*\[16;78H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[13;67H\[30m\[47m┌─────────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├─────────────────────┐\[14;67H│ Choose how to set up your management interface:                            │\[97m\[40m \[15;67H\[30m\[47m│                                                                            │\[97m\[40m \[16;67H\[30m\[47m│    \[37m\[44m(\[41m*\[44m) STATIC  Set a static IPv4 address                     \[30m\[47m              │\[97m\[40m \[17;67H\[30m\[47m│    \[37m\[44m( ) DHCP    Use DHCP to configure the Management Interface\[30m\[47m              │\[97m\[40m \[18;67H\[30m\[47m│    \[37m\[44m                                                          \[30m\[47m              │\[97m\[40m \[19;67H\[30m\[47m│    \[37m\[44m                                                          \[30m\[47m              │\[97m\[40m \[20;67H\[30m\[47m│                                                                            │\[97m\[40m \[21;67H\[30m\[47m│                                                                            │\[97m\[40m \[22;67H\[30m\[47m│                                                                            │\[97m\[40m \[23;67H\[30m\[47m│                                                                            │\[97m\[40m \[24;67H\[30m\[47m│                                                                            │\[97m\[40m \[25;67H\[30m\[47m│                                                                            │\[97m\[40m \[26;67H\[30m\[47m│                                                                            │\[97m\[40m \[27;67H\[30m\[47m│                                                                            │\[97m\[40m \[28;67H\[30m\[47m│                                                                            │\[97m\[40m \[29;67H\[30m\[47m│                                                                            │\[97m\[40m \[30;67H\[30m\[47m│                    <Ok>                        <Cancel>                    │\[97m\[40m \[31;67H\[30m\[47m│                                                                            │\[97m\[40m \[32;67H\[30m\[47m└────────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[33;68H                                                                              \[16;76H"
send -- "\[B"
expect -exact "\[16;73H\[37m\[44m*\[17;73H\[41m \[17;76H"
send -- " "
expect -exact "\[16;73H\[44m \[17;73H\[41m*\[17;76H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[16;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[17;69H│                                                                         │\[97m\[40m \[18;69H\[30m\[47m│ WARNING: Using DHCP can cause problems if your IP address changes. If   │\[97m\[40m \[19;69H\[30m\[47m│ you want to use DHCP, make sure that you have a DHCP reservation so     │\[97m\[40m \[20;69H\[30m\[47m│ that this does not occur. Otherwise, use a static IP address to be      │\[97m\[40m \[21;69H\[30m\[47m│ safe.                                                                   │\[97m\[40m \[22;69H\[30m\[47m│                                                                         │\[97m\[40m \[23;69H\[30m\[47m│ Select YES to keep DHCP or NO to go back.                               │\[97m\[40m \[24;69H\[30m\[47m│                                                                         │\[97m\[40m \[25;69H\[30m\[47m│                                                                         │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m│                    \[37m\[41m<Yes>\[30m\[47m                       <No>                     │\[97m\[40m \[28;69H\[30m\[47m│                                                                         │\[97m\[40m \[29;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[30;70H                                                                           \[27;91H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[19;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[20;69H│                                                                         │\[97m\[40m \[21;69H\[30m\[47m│ Setup will now initialize networking.                                   │\[97m\[40m \[22;69H\[30m\[47m│                                                                         │\[97m\[40m \[23;69H\[30m\[47m│ Select OK to continue.                                                  │\[97m\[40m \[24;69H\[30m\[47m│                                                                         │\[97m\[40m \[25;69H\[30m\[47m│                                 \[37m\[41m<Ok>\[30m\[47m                                    │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[28;70H                                                                           \[25;104H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[18;76H\[30m\[47m┌────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────┐\[19;76H│ How should this manager be installed?                    │\[97m\[40m \[20;76H\[30m\[47m│                                                          │\[97m\[40m \[21;76H\[30m\[47m│  \[37m\[41mStandard     This manager has internet accesss         \[30m\[47m │\[97m\[40m \[22;76H\[30m\[47m│  Airgap       This manager does not have internet access │\[97m\[40m \[23;76H\[30m\[47m│                                                          │\[97m\[40m \[24;76H\[30m\[47m│                                                          │\[97m\[40m \[25;76H\[30m\[47m│              <Ok>                  <Cancel>              │\[97m\[40m \[26;76H\[30m\[47m│                                                          │\[97m\[40m \[27;76H\[30m\[47m└──────────────────────────────────────────────────────────┘\[97m\[40m \[28;77H                                                            \[21;79H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049lRestarting Docker...\r
\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[15;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[16;69H│ How would you like to connect to the Internet?                          │\[97m\[40m \[17;69H\[30m\[47m│                                                                         │\[97m\[40m \[18;69H\[30m\[47m│ \"Direct\" - Internet requests connect directly to the Internet.          │\[97m\[40m \[19;69H\[30m\[47m│                                                                         │\[97m\[40m \[20;69H\[30m\[47m│ \"Proxy\" - proxy the traffic for git, docker client, wget, curl, yum,    │\[97m\[40m \[21;69H\[30m\[47m│ and various other SO components through a separate server in your       │\[97m\[40m \[22;69H\[30m\[47m│ environment.                                                            │\[97m\[40m \[23;69H\[30m\[47m│                                                                         │\[97m\[40m \[24;69H\[30m\[47m│                                \[37m\[41m Direct \[30m\[47m                                 │\[97m\[40m \[25;69H\[30m\[47m│                                 Proxy                                   │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m│                                                                         │\[97m\[40m \[28;69H\[30m\[47m│                                                                         │\[97m\[40m \[29;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[30;69H\[30m\[47m│                                                                         │\[97m\[40m \[31;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[32;70H                                                                           \[24;102H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[20;71H\[30m\[47m┌─────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├─────────────────┐\[21;71H│ ...                                                                │\[97m\[40m \[22;71H\[30m\[47m│                                                                    │\[97m\[40m \[23;71H\[30m\[47m│  \[32C\[97m\[44m0%\[30C\[30m\[47m  │\[97m\[40m \[24;71H\[30m\[47m│                                                                    │\[97m\[40m \[25;71H\[30m\[47m└────────────────────────────────────────────────────────────────────┘\[97m\[40m \[26;72H                                                                      \[23;104H\[21;73H\[30m\[47mRunning preflight checks...\[23;106H\[97m\[44m1\[23;104H\[23;74H\[41m \[31C\[44m2\[23;104H\[23;106H3\[23;104H\[23;75H\[41m \[30C\[44m4\[23;104H\[23;76H\[41m \[29C\[44m5\[23;104H\[23;106H6\[23;104H\[23;77H\[41m \[28C\[44m7\[23;104H\[23;78H\[41m \[27C\[44m8\[23;104H\[23;106H9\[23;104H\[?12l\[?25h\[45;1H\[37m\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[20;71H\[30m\[47m┌─────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├─────────────────┐\[21;71H│ ...                                                                │\[97m\[40m \[22;71H\[30m\[47m│                                                                    │\[97m\[40m \[23;71H\[30m\[47m│  \[32C\[97m\[44m0%\[30C\[30m\[47m  │\[97m\[40m \[24;71H\[30m\[47m│                                                                    │\[97m\[40m \[25;71H\[30m\[47m└────────────────────────────────────────────────────────────────────┘\[97m\[40m \[26;72H                                                                      \[23;104H\[21;73H\[30m\[47mChecking that all required packages are installed and enabled...\[23;106H\[97m\[44m1\[23;104H\[?12l\[?25h\[45;1H\[37m\[40m(B\[m\[39;49m\r\[K\r\[?1049lTesting if setup is running on a cloud instance...\r
\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[13;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[14;69H│ Please add NICs to the Monitor Interface:                               │\[97m\[40m \[15;69H\[30m\[47m│                                                                         │\[97m\[40m \[16;69H\[30m\[47m│    \[37m\[44m\[\[41m \[44m\]     Link UNKNOWN \[30m\[47m                                                │\[97m\[40m \[17;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[18;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[19;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[20;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[21;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[22;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[23;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[24;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[25;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[26;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[27;69H\[30m\[47m│    \[37m\[44m                     \[30m\[47m                                                │\[97m\[40m \[28;69H\[30m\[47m│                                                                         │\[97m\[40m \[29;69H\[30m\[47m│                                                                         │\[97m\[40m \[30;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[31;69H\[30m\[47m│                                                                         │\[97m\[40m \[32;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[33;70H                                                                           \[16;78H"
send -- " "
expect -exact "\[16;75H\[37m\[41m*\[16;78H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[13;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[14;69H│ Choose OS patch schedule.                                               │\[97m\[40m \[15;69H\[30m\[47m│                                                                         │\[97m\[40m \[16;69H\[30m\[47m│ This schedule will update the operating system packages but will NOT    │\[97m\[40m \[17;69H\[30m\[47m│ update Security Onion related tools such as Zeek, Elasticsearch,        │\[97m\[40m \[18;69H\[30m\[47m│ Kibana, SaltStack, etc.                                                 │\[97m\[40m \[19;69H\[30m\[47m│                                                                         │\[97m\[40m \[20;69H\[30m\[47m│    \[37m\[44m(\[41m*\[44m) Automatic        Updates installed every 8 hours if available  \[30m\[47m  │\[97m\[40m \[21;69H\[30m\[47m│    \[37m\[44m( ) Manual           Updates will be installed manually            \[30m\[47m  │\[97m\[40m \[22;69H\[30m\[47m│    \[37m\[44m( ) Import Schedule  Import named schedule on following screen     \[30m\[47m  │\[97m\[40m \[23;69H\[30m\[47m│    \[37m\[44m( ) New Schedule     Configure and name new schedule on next screen\[30m\[47m  │\[97m\[40m \[24;69H\[30m\[47m│    \[37m\[44m                                                                   \[30m\[47m  │\[97m\[40m \[25;69H\[30m\[47m│                                                                         │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m│                                                                         │\[97m\[40m \[28;69H\[30m\[47m│                                                                         │\[97m\[40m \[29;69H\[30m\[47m│                                                                         │\[97m\[40m \[30;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[31;69H\[30m\[47m│                                                                         │\[97m\[40m \[32;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[33;70H                                                                           \[20;78H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[?25l\[?12l\[?25h\[18;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[19;69H│ Enter your home network(s), separating CIDR blocks with a comma (,):    │\[97m\[40m \[20;69H\[30m\[47m│                                                                         │\[97m\[40m \[21;69H\[30m\[47m│ \[37m\[44m10.0.0.0/8,192.168.0.0/16,172.16.0.0/12________________________________\[30m\[47m │\[97m\[40m \[22;69H\[30m\[47m│                                                                         │\[97m\[40m \[23;69H\[30m\[47m│                                                                         │\[97m\[40m \[24;69H\[30m\[47m│                                                                         │\[97m\[40m \[25;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[28;70H                                                                           \[21;110H"
send -- "\r"
expect -exact "\[?25l\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[13;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[14;69H│ Choose optional services to be enabled for this installation. Be aware  │\[97m\[40m \[15;69H\[30m\[47m│ that the more services you enable the more RAM that is required.        │\[97m\[40m \[16;69H\[30m\[47m│                                                                         │\[97m\[40m \[17;69H\[30m\[47m│    \[37m\[44m\[\[41m*\[44m\] GRAFANA   Enable Grafana for system monitoring\[30m\[47m                   │\[97m\[40m \[18;69H\[30m\[47m│    \[37m\[44m\[*\] OSQUERY   Enable Fleet with osquery           \[30m\[47m                   │\[97m\[40m \[19;69H\[30m\[47m│    \[37m\[44m\[*\] WAZUH     Enable Wazuh                        \[30m\[47m                   │\[97m\[40m \[20;69H\[30m\[47m│    \[37m\[44m\[*\] PLAYBOOK  Enable Playbook                     \[30m\[47m                   │\[97m\[40m \[21;69H\[30m\[47m│    \[37m\[44m\[*\] STRELKA   Enable Strelka                      \[30m\[47m                   │\[97m\[40m \[22;69H\[30m\[47m│    \[37m\[44m                                                  \[30m\[47m                   │\[97m\[40m \[23;69H\[30m\[47m│    \[37m\[44m                                                  \[30m\[47m                   │\[97m\[40m \[24;69H\[30m\[47m│    \[37m\[44m                                                  \[30m\[47m                   │\[97m\[40m \[25;69H\[30m\[47m│                                                                         │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m│                                                                         │\[97m\[40m \[28;69H\[30m\[47m│                                                                         │\[97m\[40m \[29;69H\[30m\[47m│                                                                         │\[97m\[40m \[30;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[31;69H\[30m\[47m│                                                                         │\[97m\[40m \[32;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[33;70H                                                                           \[17;78H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[18;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[19;69H│                                                                         │\[97m\[40m \[20;69H\[30m\[47m│ Do you want to keep the default Docker IP range?                        │\[97m\[40m \[21;69H\[30m\[47m│                                                                         │\[97m\[40m \[22;69H\[30m\[47m│ If you are unsure, please accept the default option of Yes.             │\[97m\[40m \[23;69H\[30m\[47m│                                                                         │\[97m\[40m \[24;69H\[30m\[47m│                                                                         │\[97m\[40m \[25;69H\[30m\[47m│                    \[37m\[41m<Yes>\[30m\[47m                       <No>                     │\[97m\[40m \[26;69H\[30m\[47m│                                                                         │\[97m\[40m \[27;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[28;70H                                                                           \[25;91H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[?25l\[?12l\[?25h\[17;76H\[30m\[47m┌────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────┐\[18;76H│ Please enter an email address to create an administrator │\[97m\[40m \[19;76H\[30m\[47m│ account for the web interface.                           │\[97m\[40m \[20;76H\[30m\[47m│                                                          │\[97m\[40m \[21;76H\[30m\[47m│ This will also be used for Elasticsearch, Kibana, and    │\[97m\[40m \[22;76H\[30m\[47m│ Fleet.                                                   │\[97m\[40m \[23;76H\[30m\[47m│                                                          │\[97m\[40m \[24;76H\[30m\[47m│ \[37m\[44m________________________________________________________\[30m\[47m │\[97m\[40m \[25;76H\[30m\[47m│                                                          │\[97m\[40m \[26;76H\[30m\[47m│              <Ok>                  <Cancel>              │\[97m\[40m \[27;76H\[30m\[47m│                                                          │\[97m\[40m \[28;76H\[30m\[47m└──────────────────────────────────────────────────────────┘\[97m\[40m \[29;77H                                                            \[24;78H"
send -- "p"
expect -exact "\[37m\[44mp"
send -- "acker@ucwt.lan\r"
expect -exact "\[?25l\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[?25l\[?12l\[?25h\[18;76H\[30m\[47m┌────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────┐\[19;76H│ Enter a password for packer@ucwt.lan:                    │\[97m\[40m \[20;76H\[30m\[47m│                                                          │\[97m\[40m \[21;76H\[30m\[47m│ \[37m\[44m________________________________________________________\[30m\[47m │\[97m\[40m \[22;76H\[30m\[47m│                                                          │\[97m\[40m \[23;76H\[30m\[47m│                                                          │\[97m\[40m \[24;76H\[30m\[47m│                                                          │\[97m\[40m \[25;76H\[30m\[47m│              <Ok>                  <Cancel>              │\[97m\[40m \[26;76H\[30m\[47m│                                                          │\[97m\[40m \[27;76H\[30m\[47m└──────────────────────────────────────────────────────────┘\[97m\[40m \[28;77H                                                            \[21;78H"
send -- "p"
expect -exact "\[37m\[44m*"
send -- "a"
expect -exact "*"
send -- "c"
expect -exact "*"
send -- "k"
expect -exact "*"
send -- "e"
expect -exact "*"
send -- "r"
expect -exact "*"
send -- "\r"
expect -exact "\[?25l\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[?25l\[?12l\[?25h\[18;76H\[30m\[47m┌────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────┐\[19;76H│ Re-enter a password for packer@ucwt.lan:                 │\[97m\[40m \[20;76H\[30m\[47m│                                                          │\[97m\[40m \[21;76H\[30m\[47m│ \[37m\[44m________________________________________________________\[30m\[47m │\[97m\[40m \[22;76H\[30m\[47m│                                                          │\[97m\[40m \[23;76H\[30m\[47m│                                                          │\[97m\[40m \[24;76H\[30m\[47m│                                                          │\[97m\[40m \[25;76H\[30m\[47m│              <Ok>                  <Cancel>              │\[97m\[40m \[26;76H\[30m\[47m│                                                          │\[97m\[40m \[27;76H\[30m\[47m└──────────────────────────────────────────────────────────┘\[97m\[40m \[28;77H                                                            \[21;78H"
send -- "p"
expect -exact "\[37m\[44m*"
send -- "a"
expect -exact "*"
send -- "c"
expect -exact "*"
send -- "k"
expect -exact "*"
send -- "e"
expect -exact "*"
send -- "r"
expect -exact "*"
send -- "\r"
expect -exact "\[?25l\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[13;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[14;69H│ How would you like to access the web interface?                         │\[97m\[40m \[15;69H\[30m\[47m│                                                                         │\[97m\[40m \[16;69H\[30m\[47m│ Security Onion uses strict cookie enforcement, so whatever you choose   │\[97m\[40m \[17;69H\[30m\[47m│ here will be the only way that you can access the web interface.        │\[97m\[40m \[18;69H\[30m\[47m│                                                                         │\[97m\[40m \[19;69H\[30m\[47m│ If you choose something other than IP address, then you'll need to      │\[97m\[40m \[20;69H\[30m\[47m│ ensure that you can resolve the name via DNS or hosts entry. If you are │\[97m\[40m \[21;69H\[30m\[47m│ unsure, please select IP.                                               │\[97m\[40m \[22;69H\[30m\[47m│                                                                         │\[97m\[40m \[23;69H\[30m\[47m│    \[37m\[44m(\[41m*\[44m) IP        Use IP address to access the web interface       \[30m\[47m      │\[97m\[40m \[24;69H\[30m\[47m│    \[37m\[44m( ) HOSTNAME  Use hostname to access the web interface         \[30m\[47m      │\[97m\[40m \[25;69H\[30m\[47m│    \[37m\[44m( ) OTHER     Use a different name like a FQDN or Load Balancer\[30m\[47m      │\[97m\[40m \[26;69H\[30m\[47m│    \[37m\[44m                                                               \[30m\[47m      │\[97m\[40m \[27;69H\[30m\[47m│                                                                         │\[97m\[40m \[28;69H\[30m\[47m│                                                                         │\[97m\[40m \[29;69H\[30m\[47m│                                                                         │\[97m\[40m \[30;69H\[30m\[47m│                   <Ok>                       <Cancel>                   │\[97m\[40m \[31;69H\[30m\[47m│                                                                         │\[97m\[40m \[32;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[33;70H                                                                           \[23;78H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[37m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[20;84H\[30m\[47m┌────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────┐\[21;84H│                                          │\[97m\[40m \[22;84H\[30m\[47m│ Would you like to configure ntp servers? │\[97m\[40m \[23;84H\[30m\[47m│                                          │\[97m\[40m \[24;84H\[30m\[47m│         \[37m\[41m<Yes>\[30m\[47m            <No>            │\[97m\[40m \[25;84H\[30m\[47m│                                          │\[97m\[40m \[26;84H\[30m\[47m└──────────────────────────────────────────┘\[97m\[40m \[27;85H                                            \[24;95H"
send -- "\[C"
expect -exact "\[30m\[47m<Yes>\[12C\[37m\[41m<No>\[24;112H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[19;69H\[30m\[47m┌───────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────────────┐\[20;69H│                                                                         │\[97m\[40m \[21;69H\[30m\[47m│ Do you want to run so-allow to allow other machines to access this      │\[97m\[40m \[22;69H\[30m\[47m│ Security Onion installation via the web interface?                      │\[97m\[40m \[23;69H\[30m\[47m│                                                                         │\[97m\[40m \[24;69H\[30m\[47m│                    \[37m\[41m<Yes>\[30m\[47m                       <No>                     │\[97m\[40m \[25;69H\[30m\[47m│                                                                         │\[97m\[40m \[26;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[27;70H                                                                           \[24;91H"
send -- "\[C"
expect -exact "\[30m\[47m<Yes>\[23C\[37m\[41m<No>\[24;119H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[11;69H\[30m\[47m┌───┤ \[31mThe following options have been set, would you like to proceed?\[30m ├───┐\[12;69H│                                                                         │\[97m\[40m \[13;69H\[30m\[47m│ Security Onion Version: 2.3.100                                         \[37m\[41m↑\[97m\[40m \[14;69H\[30m\[47m│ Node Type: EVAL                                                         \[37m\[41m▮\[97m\[40m \[15;69H\[30m\[47m│ Hostname: securityonion2                                                \[37m\[41m▒\[97m\[40m \[16;69H\[30m\[47m│ Network: DHCP                                                           \[37m\[41m▒\[97m\[40m \[17;69H\[30m\[47m│ Management NIC: enp0s3                                                  \[37m\[41m▒\[97m\[40m \[18;69H\[30m\[47m│ Management IP: 10.0.2.15                                                \[37m\[41m▒\[97m\[40m \[19;69H\[30m\[47m│ Proxy: N/A                                                              \[37m\[41m▒\[97m\[40m \[20;69H\[30m\[47m│ Bond NIC(s):                                                            \[37m\[41m▒\[97m\[40m \[21;69H\[30m\[47m│ Home Network(s):                                                        \[37m\[41m▒\[97m\[40m \[22;69H\[30m\[47m│   - 10.0.0.0/8                                                          \[37m\[41m▒\[97m\[40m \[23;69H\[30m\[47m│   - 192.168.0.0/16                                                      \[37m\[41m▒\[97m\[40m \[24;69H\[30m\[47m│   - 172.16.0.0/12                                                       \[37m\[41m▒\[97m\[40m \[25;69H\[30m\[47m│ Access URL: https://10.0.2.15                                           \[37m\[41m▒\[97m\[40m \[26;69H\[30m\[47m│ Web User: packer@ucwt.lan                                               \[37m\[41m▒\[97m\[40m \[27;69H\[30m\[47m│ Fleet User: packer@ucwt.lan                                             \[37m\[41m▒\[97m\[40m \[28;69H\[30m\[47m│ Enabled Optional Components:                                            \[37m\[41m▒\[97m\[40m \[29;69H\[30m\[47m│   - GRAFANA                                                             \[37m\[41m▒\[97m\[40m \[30;69H\[30m\[47m│   - OSQUERY                                                             \[37m\[41m↓\[97m\[40m \[31;69H\[30m\[47m│                                                                          \[97m\[40m \[32;69H\[30m\[47m│                    <Yes>                       <No>                      \[97m\[40m \[33;69H\[30m\[47m│                                                                         │\[97m\[40m \[34;69H\[30m\[47m└─────────────────────────────────────────────────────────────────────────┘\[97m\[40m \[35;70H                                                                           \[13;71H"
send -- "\r\[C"
expect -exact "\[13;143H\[30m\[47m↑\[14;143H▮\[15;143H▒\[16;143H▒\[17;143H▒\[18;143H▒\[19;143H▒\[20;143H▒\[21;143H▒\[22;143H▒\[23;143H▒\[24;143H▒\[25;143H▒\[26;143H▒\[27;143H▒\[28;143H▒\[29;143H▒\[30;143H↓\[32;90H\[37m\[41m<Yes>\[32;91H"
send -- "\r"
expect -exact "\[?12l\[?25h\[45;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[20;71H\[30m\[47m┌─────────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├─────────────────┐\[21;71H│ Please wait while installing...                                    │\[97m\[40m \[22;71H\[30m\[47m│                                                                    │\[97m\[40m \[23;71H\[30m\[47m│  \[32C\[97m\[44m0%\[30C\[30m\[47m  │\[97m\[40m \[24;71H\[30m\[47m│                                                                    │\[97m\[40m \[25;71H\[30m\[47m└────────────────────────────────────────────────────────────────────┘\[97m\[40m \[26;72H                                                                      \[23;104H\[21;73H\[30m\[47mRunning initial configuration steps\[23;104H\[21;73HUpdating packages                  \[23;74H\[97m\[41m \[31C\[44m2\[23;104H\[21;73H\[30m\[47mGenerating sensor pillar\[23;106H\[97m\[44m3\[23;104H\[21;73H\[30m\[47mConfiguring sensor interface\[23;75H\[97m\[41m \[30C\[44m4\[23;104H\[21;73H\[30m\[47mInstalling Salt and dependencies\[23;76H\[97m\[41m \[29C\[44m5\[23;104H\[21;84H\[30m\[47mvarious dependencies \[23;106H\[97m\[44m6\[23;104H\[21;84H\[30m\[47msalt-master         \[23;77H\[97m\[41m \[28C\[44m7\[23;104H\[21;90H\[30m\[47minion & python modules\[23;78H\[97m\[41m \[27C\[44m8\[23;104H\[21;84H\[30m\[47mDocker and dependencies     \[23;104H\[21;73HGenerating patch pillar           \[23;104H\[21;73HInitializing Salt minion\[23;104H\[21;73HConfiguring Salt master \[23;106H\[97m\[44m9\[23;104H\[21;73H\[30m\[47mUpdating sudoers file for soremote user\[23;79H\[97m\[41m \[25C\[44m10\[23;104H\[21;73H\[30m\[47mGenerating manager global pillar       \[23;80H\[97m\[41m \[25C\[44m1\[23;104H\[21;92H\[30m\[47mpillar       \[23;106H\[97m\[44m2\[23;104H\[21;73H\[30m\[47mRunning first Salt checkin\[23;81H\[97m\[41m   \[22C\[44m6\[23;104H\[21;73H\[30m\[47mSetting node type         \[23;84H\[97m\[41m \[21C\[44m8\[23;104H\[21;73H\[30m\[47mAccepting Salt key\[23;85H\[97m\[41m \[19C\[44m20\[23;104H\[21;73H\[30m\[47mCopying minion pillars to manager\[23;86H\[97m\[41m \[19C\[44m1\[23;104H\[21;73H\[30m\[47mGenerating CA                    \[23;87H\[97m\[41m \[18C\[44m3\[23;104H\[21;84H\[30m\[47mSSL\[23;88H\[97m\[41m \[17C\[44m4\[23;104H\[21;73H\[30m\[47mConfiguring firewall\[23;89H\[97m\[41m \[16C\[44m5\[23;104H\[21;75H\[30m\[47mpying containers from iso\[23;106H\[97m\[44m6\[23;104H\[21;73H\[30m\[47mApplying manager Salt state\[23;90H\[97m\[41m               60%    \[23;104H\[21;82H\[30m\[47mfirewall Salt state\[23;106H\[97m\[41m1\[5C \[23;104H\[21;73H\[30m\[47mInstalling Yum utilities    \[23;104H\[21;73HApplying common Salt state\[23;106H\[97m\[41m2\[23;104H\[21;82H\[30m\[47mnginx Salt state \[23;104H\[21;82Hidstools Salt state\[23;106H\[97m\[41m3\[6C \[23;104H\[21;82H\[30m\[47msuricata.manager Salt state\[23;104H\[21;82Helasticsearch Salt state   \[23;106H\[97m\[41m4\[23;104H\[21;82H\[30m\[47mpcap Salt state         \[23;106H\[97m\[41m5\[7C \[23;104H\[21;82H\[30m\[47msuricata Salt state\[23;106H\[97m\[41m6\[8C \[23;104H\[21;82H\[30m\[47mzeek Salt state    \[23;106H\[97m\[41m7\[23;104H\[21;82H\[30m\[47mcurator Salt state\[23;106H\[97m\[41m8\[9C \[23;104H\[21;82H\[30m\[47msoc Salt state    \[23;106H\[97m\[41m9\[10C \[23;104H\[21;82H\[30m\[47mkibana Salt state\[23;105H\[97m\[41m70\[23;104H\[21;73H\[30m\[47mSetting up default Space in Kibana\[23;104H\[21;73HApplying playbook.db_init Salt state\[23;106H\[97m\[41m1\[11C \[23;104H\[21;90H\[30m\[47m Salt state        \[23;104H\[21;90H.automation_user_create Salt state\[23;104H\[21;82Helastalert Salt state                     \[23;106H\[97m\[41m2\[12C \[23;104H\[21;82H\[30m\[47msoctopus Salt state  \[23;106H\[97m\[41m3\[23;104H\[21;73H\[30m\[47mUpdate playbook rules       \[23;104H\[21;73HInstalling InfluxDB and Grafana\[23;106H\[97m\[41m4\[13C \[23;104H\[21;73H\[30m\[47mApplying fleet.event_enable-fleet Salt state\[23;106H\[97m\[41m5\[14C \[23;104H\[21;87H\[30m\[47m Salt state                   \[23;104H\[21;82Hredis\[23;106H\[97m\[41m6\[23;104H\[21;82H\[30m\[47mso-fleet-setup Salt state\[23;106H\[97m\[41m8\[15C \[23;104H\[21;82H\[30m\[47mwazuh Salt state         \[23;106H\[97m\[41m9\[16C \[23;104H\[21;82H\[30m\[47mstrelka Salt state\[23;105H\[97m\[41m81\[17C \[23;104H\[21;82H\[30m\[47mutility\[23;106H\[97m\[41m2\[18C \[23;104H\[21;82H\[30m\[47mfinishing touches \[23;106H\[97m\[41m5\[19C  \[23;104H\[21;74H\[30m\[47mdding user to SOC        \[23;106H\[97m\[41m7\[21C \[23;104H\[21;73H\[30m\[47mEnabling checkin at boot\[23;105H\[97m\[41m90\[22C  \[23;104H\[21;73H\[30m\[47mVerifying setup         \[23;106H\[97m\[41m5\[24C   \[23;104H\[?12l\[?25h\[45;1H\[37m\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;45r\[4l\[?25l(B\[m\[37m\[40m\[1;45r\[H\[2J\[1;1H\[97m\[44m\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K
\[K\[1;1H\[20;76H\[30m\[47m┌────────────┤ \[31mSecurity Onion Setup - 2.3.100\[30m ├────────────┐\[21;76H│ Running post-installation steps...                       │\[97m\[40m \[22;76H\[30m\[47m│                                                          │\[97m\[40m \[23;76H\[30m\[47m│  \[97m\[41m                          96%                      \[44m   \[30m\[47m  │\[97m\[40m \[24;76H\[30m\[47m│                                                          │\[97m\[40m \[25;76H\[30m\[47m└──────────────────────────────────────────────────────────┘\[97m\[40m \[26;77H                                                            \[23;104H\[21;78H\[30m\[47mGenerating archive fo